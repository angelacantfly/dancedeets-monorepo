{% extends class_base_template %}

{% block title %}
{{ result_title }}
{% endblock %}

{% block head_stylesheet %}
    <meta property="og:image" content="https://www.dancedeets.com/images/deet-city.jpg" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="{{ result_title }}" />
    <meta property="og:site_name" content="DanceDeets"/>
    <meta property="og:description"
          content="Every street dance event. On the web, on your phone. At home, and when traveling."/>
{% endblock %}

{% block body %}
<div class="container">
  <div class="row">
    <div id="react-parent">
      {{ react_html|safe }}
    </div>
    <script type="text/javascript">
      window._REACT_PROPS = {{ react_props|safe }};
      window._REACT_ID = 'react-parent';
    </script>
    <div class="col-md-3">
      <a href="/events_add" class="btn btn-primary" style="margin-bottom: 10px"><i class="fa fa-calendar-plus-o fa-lg"></i> Add Dance Event</a>
      <button type="button" class="btn btn-primary" style="margin-bottom: 10px" onclick="share(); return true;"><i class="fa fa-user-plus fa-lg"></i> Share on Facebook</button>
      <div class="rankings" style="margin-bottom: 10px">
      <a href="/rankings"><i class="fa fa-list-ol fa-lg"></i> City Rankings</a>.
      </div>
      <div class="fb-like" data-href="https://www.facebook.com/dancedeets/" data-width="225" data-layout="standard" data-action="like" data-size="small" data-show-faces="true" data-colorscheme="dark"><blockquote cite="https://www.facebook.com/dancedeets/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/dancedeets/">DanceDeets</a></blockquote></div>

      <div style="margin-top: 20px">
        <!-- Google Ad: search-right -->
        <ins class="adsbygoogle"
             style="display:inline-block;width:300px;height:600px"
             data-ad-client="ca-pub-9162736050652644"
             data-ad-slot="6881574572">
        </ins>
        <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      </div>
    </div>
  </div> {# row #}
</div> {# container #}
{% endblock %}

{% block bottom_javascript %}
{% if selected_tab == 'calendar' %}
<script src="{{static_dir}}/js/calendarExec.js"></script>
{% else %}
<script src="{{static_dir}}/js/eventSearchResultsExec.js"></script>
{% endif %}

<script type="text/javascript">
/*
jQuery(document).ready(function(event) {
  jQuery("body").delegate("#location_input", "click", function() { return false; });
  jQuery('#keywords_input').keydown(function(event) {
      if (event.keyCode == 13) {
          this.form.submit();
          return false;
       }
  });
  jQuery('#location_input').keydown(function(event) {
      if (event.keyCode == 13) {
          this.form.submit();
          return false;
       }
  });
});
*/
function initializeLocationAutocomplete() {
  var autocomplete = new google.maps.places.Autocomplete(jQuery('#location_input').get(0));
  autocomplete.setTypes(['(regions)']);
}

function share() {
  FB.ui({
    method: 'share',
    mobile_iframe: true,
    href: 'https://www.dancedeets.com/',
  }, function(response){});
}

</script>
{#
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;key=AIzaSyAvvrWfamjBD6LqCURkATAWEovAoBm1xNQ&amp;libraries=places&amp;callback=initializeLocationAutocomplete"></script>
#}

{% if selected_tab == 'calendar' %}

<style type="text/css">
/** We want to see the whole city and title, so let's ensure we override 'white-space: nowrap'.
  * This is discussed in more detail here, which is when 2.1 introduced table-based event layout:
  * https://code.google.com/p/fullcalendar/issues/detail?id=1992
  **/
.fc-day-grid-event > .fc-content {
  white-space: normal;
}
</style>

<script type="text/javascript">
mixpanel.track("Search Events", {
  "Location": {{ form.location.data|tojson }},
  "Keywords": {{ form.keywords.data|tojson }}
});

mixpanel.track("Searched Results", {
  "Location": {{ form.location.data|tojson }},
  "Keywords": {{ form.keywords.data|tojson }},
  "Tab": "CALENDAR"
});
</script>
{% else %}
{#
<script type="text/javascript">
mixpanel.track("Search Events", {
  "Location": {{ form.location.data|tojson }},
  "Keywords": {{ form.keywords.data|tojson }}
});
{% if selected_tab == 'past' %}
  var num_results = {{ len(past_results) }};
  var tab = 'PAST';
{% elif selected_tab == 'present' %}
  var num_results = {{ num_upcoming_results }};
  var tab = 'UPCOMING';
{% else %}
  var tab = null;
{% endif %}

if (tab != null) {
  mixpanel.track("Searched Results", {
    "Location": {{ form.location.data|tojson }},
    "Keywords": {{ form.keywords.data|tojson }},
    "Tab": tab,
    "Result Count": num_results,
    "Onebox Count": {{ len(onebox_links) }}
  });
}
mixpanel.track_links(".link-onebox", "Onebox");
</script>

{{ rsvp.rsvp_script() }}
#}
{% endif %}
{% endblock %}
